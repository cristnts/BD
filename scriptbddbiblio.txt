----- TABLAS -----

CREATE TABLE autor(
  CODAUT int NOT NULL,
  NOMBREAUTOR varchar(20) NOT NULL,
  APELLIDOPAT varchar(20) NOT NULL,
  APELLIDOMAT varchar(20) NOT NULL
);

CREATE TABLE categoria (
  CODCAT int NOT NULL,
  NOMBRECATEGORIA varchar(20) NOT NULL
);

CREATE TABLE ciudad (
  COD_CIU int NOT NULL,
  NOMBRECIUDAD varchar(45) NULL,
);

CREATE TABLE cliente (
  RUTCLIENTE varchar(45) NOT NULL,
  APELLIDOPAT varchar(30) NOT NULL,
  APELLIDOMAT varchar(30) NOT NULL,
  NOMBRECLIENTE varchar(30) NOT NULL,
  TELEFONO int NOT NULL,
  DIRECCION varchar(45) NOT NULL,
  FECHANACIMIENTO date NOT NULL,
  CODCOM int NOT NULL
);


CREATE TABLE comuna (
  CODCOM int NOT NULL,
  NOMBRECOMUNA varchar(45),
  CODCIU int NOT NULL
);

CREATE TABLE distribuidores (
  RUTDIS varchar(10) NOT NULL,
  TELEFONO int NOT NULL,
  AÑOINICIO int DEFAULT NULL,
  DIRECCION varchar(45),
  CODCO int NOT NULL,
  CODEDIT int NOT NULL,
);

CREATE TABLE editorial (
  CODEDIT int(11) NOT NULL,
  NOMBREEDIT varchar(20)
);

CREATE TABLE estadolibro (
  CODESTL int(11) NOT NULL,
  NOMBREESTL varchar(20) 
);
CREATE TABLE estadocliente (
  CODESTC int(11) NOT NULL,
  NOMBREESTC varchar(20)
);
CREATE TABLE factura (
  FOLIO int NOT NULL,
  COSTOCONIVA int NOT NULL,
  PRECIONETO int NOT NULL,
  FECHADEVENTA date NOT NULL,
  HORADEVENTA date NOT NULL
);

CREATE TABLE idioma (
  CODIDIO int NOT NULL,
  NOMBREIDIOMA varchar(20) NOT NULL
);
CREATE TABLE libro (
  NMSERIE int NOT NULL,
  ISBN varchar(11) NOT NULL,
  NOMBRE varchar(20) NOT NULL,
  AÑO int NOT NULL,
  COD_EDIT int NOT NULL,
  COD_AUTOR int NOT NULL,
  COD_ID int NOT NULL,
  COD_CAT int NOT NULL,
  COD_EST int NOT NULL
);
CREATE TABLE trabajadores (
  RUTTRABAJADOR varchar(10) NOT NULL,
  NOMBRETRABAJADOR varchar(45) NOT NULL,
  APELLIDOPATERNO varchar(30) NOT NULL,
  APELLIDOMATERNO varchar(30) NOT NULL,
  TELEFONO int NOT NULL,
  FECHANACIMIENTO date NOT NULL,
  FECHACONTRATO date not null,
  DIRECCION varchar(45) NOT NULL,
  COD_TIPO int NOT NULL,
  COD_CO int not null
);
CREATE TABLE venta_libros (
CODVENTA int NOT NULL,
PRECIO int not null,
CODBO int, not null
);
CREATE TABLE arriendo_libros(
FECHAENTREGA date not null,
CODARRIENDO int not null,
FECHAARRIENDO date not null
);
CREATE TABLE ejemplar (
NOMBREEJEMPLAR varchar(20) not null,
CODEJEM int not null,
NUMEJEMPLAR int not null,
CODLIBRO int not null
);
CREATE TABLE cargo (
NOMBRECARGO varchar(20) not null,
TIPOCARGO varchar(20) not null,
CODCARGO int not null,
RUTTRABAJADOR int not null
);
CREATE TABLE detalles_factura (
CODDETA int not null,
COSTO int not null,
METODOPAGO varchar(20) not null,
PRECIO int not null,
CODFACTURA int not null
);
CREATE TABLE compra_libros (
NUMSERIE int not null,
FOLIO int not null,
CODLIBRO int not null,
CODBOL int not null
);
CREATE TABLE boleta (
CODBOL int not null,
PRECIOVA int not null,
COSTOIVA int not null,
HORAVENTA int not null,
FOLIO int not null,
PRECIONETO int not null,
FECHAVENTA date not null,
METODOPAGO varchar(20) not null,
RUTCLIENTE int not null
);


----- PRIMARY Y FOREIGN KEY -----
ALTER TABLE arriendo_libros
 ADD PRIMARY KEY (CODARRIENDO);
ALTER TABLE autor
  ADD PRIMARY KEY (CODAUTOR);
ALTER TABLE boleta
  ADD PRIMARY KEY (CODBOL);
ALTER TABLE categoria  ADD PRIMARY KEY (CODCATEGORIA);
ALTER TABLE ciudad  ADD PRIMARY KEY (CODCIU);
ALTER TABLE cliente
  ADD PRIMARY KEY (RUTCLIENTE);
ALTER TABLE compra_libros  ADD PRIMARY KEY (FOLIO);
ALTER TABLE comuna ADD PRIMARY KEY (CODCOM);
ALTER TABLE distribuidor  ADD PRIMARY KEY (RUTDIS);
ALTER TABLE cargo ADD PRIMARY KEY (CODCAR);
ALTER TABLE editorial
  ADD PRIMARY KEY (CODEDIT);
ALTER TABLE estadolibros
  ADD PRIMARY KEY (CODESTL);
ALTER TABLE estadocliente ADD PRIMARY KEY (CODESTC);
ALTER TABLE factura
  ADD PRIMARY KEY (CODFACTURA);
ALTER TABLE idioma
  ADD PRIMARY KEY (CODIDIO);
ALTER TABLE libro ADD PRIMARY KEY (CODLIBRO);
ALTER TABLE trabajadores
  ADD PRIMARY KEY (RUTTRABAJADOR);
ALTER TABLE venta
_libros  ADD PRIMARY KEY (CODVENTA);
ALTER TABLE ejemplar ADD PRIMARY KEY (CODEJEM);
ALTER TABLE detalles_factura ADD PRIMARY KEY (CODDETA);


ALTER TABLE cliente
  
ADD CONSTRAINT CLIENTE_COD_COM_FK FOREIGN KEY (CODCOM) REFERENCES comuna (COD_COM);

ALTER TABLE compra
  
ADD CONSTRAINT `COMPRA_LIBROS_FOLIO_FK FOREIGN KEY (FOLIO) REFERENCES factura
 (FOLIO),
 ADD CONSTRAINT COMPRA_LIBROS_NMSERIE_FK FOREIGN KEY (NMSERIE) REFERENCES
 libro (NMSERIE),

  ADD CONSTRAINT COMPRA_LIBROS_RUTTRABAJADOR_FK FOREIGN KEY (RUTTRABAJADOR) REFERENCES
 trabajadores (RUTTRABAJADOR),

  ADD CONSTRAINT compra_RUT_DIS_FK FOREIGN KEY (RUTDIS) REFERENCES
 distribuidor (RUTDIS);

ALTER TABLE comuna
  ADD CONSTRAINT COMUNA_COD_CIU_FK FOREIGN KEY (CODCIU) REFERENCES ciudad (CODCIU);

ALTER TABLE distribuidores

  ADD CONSTRAINT distribuidores_CODEDIT_FK FOREIGN KEY (CODEDIT) REFERENCES editorial (CODEDIT),
  ADD CONSTRAINT distribuidores_CODCOM_FK FOREIGN KEY (CODCOM) REFERENCES comuna (CODCOM),

  ADD CONSTRAINT distribuidores_RUTTRABAJADOR_FK FOREIGN KEY (RUTTRABAJADOR) REFERENCES trabajadores (RUTTRAJABADOR);

ALTER TABLE libro
  
ADD CONSTRAINT LIBRO_CODAUT_FK FOREIGN KEY (CODAUT) REFERENCES autor (CODAUT),

  ADD CONSTRAINT LIBRO_CODCAT_FK FOREIGN KEY (CODCAT) REFERENCES categoria (COD_CAT),

  ADD CONSTRAINT LIBRO_CODEDIT_FK FOREIGN KEY (CODEDIT) REFERENCES editorial (CODEDIT),

  ADD CONSTRAINT LIBRO_CODESTL_FK FOREIGN KEY (CODESTL) REFERENCES estado (CODESTL),

  ADD CONSTRAINT LIBRO_CODIDIO_FK FOREIGN KEY (CODIDIO) REFERENCES idioma (CODIDIO);
ALTER TABLE trabajadores 
 ADD CONSTRAINT TRABAJADORES_CODCOM_FK FOREIGN KEY (CODCOM) REFERENCES comuna (CODCOM),

  ADD CONSTRAINT TRABAJADORES_CODCAR_FK FOREIGN KEY (CODCAR) REFERENCES cargo (CODCAR);

ALTER TABLE venta_libros
 
 ADD CONSTRAINT VENTA_LIBROS_CODBOL_FK FOREIGN KEY (CODBOL) REFERENCES boleta (CODBOL),
  ADD CONSTRAINT VENTA_LIBROS_NSERIE_FK FOREIGN KEY (NMSERIE) REFERENCES libro (NMSERIE),

  ADD CONSTRAINT VENTA_LIBROS_RUTCLIENTE_FK FOREIGN KEY (RUTCLIENTE) REFERENCES cliente (RUTCLIENTE),

  ADD CONSTRAINT VENTA_LIBROS_RUTTTRABAJADOR_FK FOREIGN KEY (RUTTRABAJADOR) REFERENCES trabajadores (RUTTRABAJADOR);